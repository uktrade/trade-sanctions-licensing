{% extends "core/base_form_step.html" %}
{% load crispy_forms_tags crispy_forms_gds %}


{% block title %}You've added {{ businesses |length }} business{% if businesses|length > 1 or businesses|length == 0 %}es{% endif %}{% endblock title %}

{% block column_content %}
    <h1 class="govuk-heading-l">
        You've added {{ businesses|length }} business{% if businesses|length > 1 or businesses|length == 0 %}es{% endif %}
    </h1>
    {% for business in businesses %}
        <div class="action-wrapper">
            <div>
                <h2 class="govuk-heading-m" style="float:left;">Business {{ forloop.counter }} </h2>
                <ul class="govuk-summary-card__actions">
                    {% if business.business_registered_on_companies_house == "yes" %}
                        <a class="govuk-link govuk-summary-list__action govuk-!-font-weight-regular" style="font-size: 19px; text-align:right"
                           href="{% url 'do_you_know_the_registered_company_number' licence_pk=licence.id business_id=business.id  %}?change=yes">Change<span
                            class="govuk-visually-hidden"> Business {{forloop.counter}} details </span></a>
                    {% elif business.country == "GB" %}
                        <a class="govuk-link govuk-summary-list__action govuk-!-font-weight-regular" style="font-size: 19px; text-align:right"
                           href="{% url 'add_a_business' licence_pk=licence.id location='in-uk' business_id=business.id %}?change=yes">Change<span
                            class="govuk-visually-hidden"> Business {{forloop.counter}} details </span></a>
                    {% else %}
                        <a class="govuk-link govuk-summary-list__action govuk-!-font-weight-regular" style="font-size: 19px; text-align:right"
                           href="{% url 'add_a_business' licence_pk=licence.id location='outside-uk' business_id=business.id %}?change=yes">Change<span
                            class="govuk-visually-hidden"> Business {{forloop.counter}} details </span></a>
                    {% endif %}
                </ul>
            </div>
        </div>
        <dl class="govuk-summary-list">
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                    Business name
                </dt>
                <dd class="govuk-summary-list__value" data-testid="business-name-{{ forloop.counter }}">
                    {% if business.name %}
                        {{ business.name }}
                    {% else %}
                        Not yet added
                    {% endif %}
                </dd>
            </div>
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                    Address
                </dt>
                <dd class="govuk-summary-list__value" data-testid="business-address-{{ forloop.counter }}">
                    {% if business.readable_address %}
                        {{ business.readable_address | linebreaksbr }}
                    {% else %}
                        Not yet added
                    {% endif %}
                </dd>
            </div>
            {% if businesses|length > 1 %}
                <form id="delete_business_form_{{ forloop.counter }}" method="post" enctype='multipart/form-data' novalidate
                      action="{% url 'delete_business' licence_pk=licence.id business_id=business.id%}">
                    <input type="hidden" name="business_id" value="{{ business.id }}">
                    {% csrf_token %}
                    <button type="submit" class="govuk-body button-that-looks-like-link" form="delete_business_form_{{ forloop.counter }}">
                        Remove Business {{ forloop.counter }} <span
                            class="govuk-visually-hidden"> Business {{forloop.counter}}</span>
                    </button>
                </form>
            {% endif %}
        </dl>
    {% endfor %}
    {% error_summary form %}
    <form action="{{ request.get_full_path }}" method="post" enctype='multipart/form-data' novalidate>
        {% csrf_token %}
        {% crispy form %}
    </form>
{% endblock column_content %}
